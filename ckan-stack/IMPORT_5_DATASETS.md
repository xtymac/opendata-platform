# åªå¯¼å…¥ 5 ä¸ª PLATEAU æ•°æ®é›†

## ğŸ¯ é—®é¢˜
DCAT Harvester ä¼šé‡‡é›†æ•´ä¸ª catalog (100+ æ•°æ®é›†)ï¼Œå¦‚æœåªæƒ³è¦ 5 ä¸ªæ•°æ®é›†æ€ä¹ˆåŠï¼Ÿ

## âœ… è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨å¯¼å…¥è„šæœ¬

æˆ‘å·²ä¸ºæ‚¨å‡†å¤‡å¥½äº†å¯¼å…¥è„šæœ¬ï¼Œå¯ä»¥ç²¾ç¡®å¯¼å…¥ 5 ä¸ªæ¨èçš„ PLATEAU æ•°æ®é›†ã€‚

---

## ğŸ“‹ æ–¹æ¡ˆ 1ï¼šPython è„šæœ¬ï¼ˆæ¨èï¼‰

### 1. å‡†å¤‡ API Key

é¦–å…ˆéœ€è¦è·å– CKAN API Keyï¼š

1. è®¿é—®: https://opendata.uixai.org/user/login
2. ç™»å½•åï¼Œç‚¹å‡»å³ä¸Šè§’ç”¨æˆ·å
3. é€‰æ‹© "API Tokens"
4. åˆ›å»ºä¸€ä¸ªæ–° token æˆ–å¤åˆ¶ç°æœ‰ token

### 2. è¿è¡Œå¯¼å…¥è„šæœ¬

```bash
cd /home/ubuntu/ckan-stack
python3 import_plateau_simple.py
```

### 3. æŒ‰ç…§æç¤ºæ“ä½œ

è„šæœ¬ä¼šï¼š
1. æ˜¾ç¤ºå°†è¦å¯¼å…¥çš„ 5 ä¸ªæ•°æ®é›†
2. è¦æ±‚ç¡®è®¤
3. è¦æ±‚è¾“å…¥ API Key
4. è‡ªåŠ¨ä» Gç©ºé–“æƒ…å ±ã‚»ãƒ³ã‚¿ãƒ¼ è·å–æ•°æ®å¹¶å¯¼å…¥

### 4. é‡å»ºæœç´¢ç´¢å¼•

```bash
docker exec ckan ckan -c /srv/app/ckan.ini search-index rebuild
```

### 5. æŸ¥çœ‹ç»“æœ

è®¿é—®: https://opendata.uixai.org/dataset?q=plateau

---

## ğŸ“¦ å°†å¯¼å…¥çš„æ•°æ®é›†

1. **æ±äº¬éƒ½åƒä»£ç”°åŒº 2023** (`plateau-13100-chiyoda-ku-2023`)
   - ä¸œäº¬éƒ½å¿ƒéƒ¨çš„ 3D éƒ½å¸‚æ¨¡å‹
   - åŒ…å«å»ºç¯‰ç‰©ã€é“è·¯ç­‰æ•°æ®

2. **å¤§é˜ªå¸‚ 2023** (`plateau-27100-osaka-shi-2023`)
   - å¤§é˜ªå¸‚çš„ 3D éƒ½å¸‚æ¨¡å‹
   - è¥¿æ—¥æœ¬ä¸»è¦åŸå¸‚

3. **æ¨ªæµœå¸‚ 2022** (`plateau-14100-yokohama-shi-2022`)
   - æ¨ªæµœå¸‚çš„ 3D éƒ½å¸‚æ¨¡å‹
   - åŒ…å«æ¸¯å£åŒºåŸŸ

4. **åå¤å±‹å¸‚ 2022** (`plateau-23100-nagoya-shi-2022`)
   - åå¤å±‹å¸‚çš„ 3D éƒ½å¸‚æ¨¡å‹
   - ä¸­éƒ¨åœ°åŒºä¸»è¦åŸå¸‚

5. **ç¦å²¡å¸‚ 2021** (`plateau-40100-fukuoka-shi-2021`)
   - ç¦å²¡å¸‚çš„ 3D éƒ½å¸‚æ¨¡å‹
   - ä¹å·ä¸»è¦åŸå¸‚

---

## ğŸ”§ æ–¹æ¡ˆ 2ï¼šæ‰‹åŠ¨é€‰æ‹©æ•°æ®é›†

å¦‚æœæ‚¨æƒ³é€‰æ‹©ä¸åŒçš„æ•°æ®é›†ï¼š

### 1. æµè§ˆ Gç©ºé–“æƒ…å ±ã‚»ãƒ³ã‚¿ãƒ¼

è®¿é—®: https://www.geospatial.jp/ckan/dataset?q=plateau

### 2. é€‰æ‹©æ•°æ®é›†

æ‰¾åˆ°æ‚¨æƒ³è¦çš„æ•°æ®é›†ï¼Œè®°å½•å…¶ IDï¼ˆURL ä¸­çš„æœ€åéƒ¨åˆ†ï¼‰

### 3. ä¿®æ”¹è„šæœ¬

ç¼–è¾‘ `import_plateau_simple.py`ï¼Œä¿®æ”¹ `DATASETS` åˆ—è¡¨ï¼š

```python
DATASETS = [
    {
        "id": "æ‚¨é€‰æ‹©çš„æ•°æ®é›†ID",
        "name": "æ•°æ®é›†åç§°"
    },
    # ... æ·»åŠ æ›´å¤š
]
```

### 4. è¿è¡Œè„šæœ¬

```bash
python3 import_plateau_simple.py
```

---

## ğŸš€ æ–¹æ¡ˆ 3ï¼šé€šè¿‡ CKAN UI æ‰‹åŠ¨å¯¼å…¥å•ä¸ªæ•°æ®é›†

å¦‚æœæ‚¨æƒ³å®Œå…¨æ‰‹åŠ¨æ“ä½œï¼š

### 1. ä»æº CKAN è·å–æ•°æ®é›† JSON

```bash
# é€‰æ‹©ä¸€ä¸ªæ•°æ®é›† ID
DATASET_ID="plateau-13100-chiyoda-ku-2023"

# ä¸‹è½½æ•°æ®é›†ä¿¡æ¯
curl "https://www.geospatial.jp/ckan/api/3/action/package_show?id=$DATASET_ID" \
  | jq '.result' > dataset.json
```

### 2. ç¼–è¾‘ JSON

åˆ é™¤ä¸éœ€è¦çš„å­—æ®µï¼š
- `id`
- `revision_id`
- `creator_user_id`
- `metadata_created`
- `metadata_modified`
- `organization`

### 3. é€šè¿‡ API å¯¼å…¥

```bash
curl -X POST http://localhost:5000/api/3/action/package_create \
  -H "Authorization: YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d @dataset.json
```

### 4. é‡å¤ 5 æ¬¡

å¯¹æ¯ä¸ªæƒ³è¦çš„æ•°æ®é›†é‡å¤æ­¤è¿‡ç¨‹ã€‚

---

## ğŸ” æ–¹æ¡ˆ 4ï¼šåˆ›å»ºè‡ªå®šä¹‰ Harvesterï¼ˆé«˜çº§ï¼‰

å¦‚æœæ‚¨éœ€è¦æ›´çµæ´»çš„æ§åˆ¶ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰ harvester æ¥é™åˆ¶é‡‡é›†æ•°é‡ã€‚

ä¿®æ”¹ harvester çš„ gather é˜¶æ®µï¼š

```python
def gather_stage(self, harvest_job):
    # ... åŸæœ‰ä»£ç  ...

    # é™åˆ¶ä¸º 5 ä¸ª
    ids = ids[:5]

    # ... åˆ›å»º HarvestObject ...
```

ä½†è¿™éœ€è¦ä¿®æ”¹æ’ä»¶ä»£ç ï¼Œæ¯”è¾ƒå¤æ‚ã€‚

---

## ğŸ“Š å¯¹æ¯”å„æ–¹æ¡ˆ

| æ–¹æ¡ˆ | éš¾åº¦ | çµæ´»æ€§ | æ¨èåº¦ |
|------|------|--------|--------|
| Python è„šæœ¬ | â­ ç®€å• | â­â­â­ ä¸­ç­‰ | â­â­â­â­â­ å¼ºçƒˆæ¨è |
| Bash è„šæœ¬ | â­â­ ä¸­ç­‰ | â­â­â­ ä¸­ç­‰ | â­â­â­â­ æ¨è |
| æ‰‹åŠ¨å¯¼å…¥ | â­ ç®€å• | â­â­â­â­â­ æœ€é«˜ | â­â­â­ é€‚åˆæµ‹è¯• |
| è‡ªå®šä¹‰ Harvester | â­â­â­â­â­ å›°éš¾ | â­â­â­â­â­ æœ€é«˜ | â­â­ ä»…é«˜çº§ç”¨æˆ· |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **API Key æƒé™**
   - éœ€è¦ sysadmin æˆ–å…·æœ‰ package_create æƒé™çš„ç”¨æˆ·
   - ä¸è¦åˆ†äº«æ‚¨çš„ API Key

2. **æ•°æ®é›† ID å¯èƒ½å˜åŒ–**
   - Gç©ºé–“æƒ…å ±ã‚»ãƒ³ã‚¿ãƒ¼ å¯èƒ½ä¼šæ›´æ–°æ•°æ®é›† ID
   - å¦‚æœå¯¼å…¥å¤±è´¥ï¼Œå…ˆæ£€æŸ¥æ•°æ®é›†æ˜¯å¦å­˜åœ¨

3. **èµ„æºé“¾æ¥**
   - å¯¼å…¥çš„æ˜¯å…ƒæ•°æ®ï¼Œèµ„æºæ–‡ä»¶ä»æ‰˜ç®¡åœ¨ Gç©ºé–“æƒ…å ±ã‚»ãƒ³ã‚¿ãƒ¼
   - å¦‚æœéœ€è¦æœ¬åœ°åŒ–èµ„æºï¼Œéœ€è¦é¢å¤–ä¸‹è½½

4. **é‡å¤å¯¼å…¥**
   - å¦‚æœæ•°æ®é›†å·²å­˜åœ¨ï¼Œå¯¼å…¥ä¼šå¤±è´¥
   - å¯ä»¥å…ˆåˆ é™¤æ—§æ•°æ®é›†ï¼Œæˆ–ä¿®æ”¹æ–°æ•°æ®é›†çš„ name

---

## âœ… å¿«é€Ÿå¼€å§‹

**æœ€ç®€å•çš„æ–¹æ³•ï¼š**

```bash
# 1. è¿è¡Œå¯¼å…¥è„šæœ¬
cd /home/ubuntu/ckan-stack
python3 import_plateau_simple.py

# 2. æŒ‰æç¤ºè¾“å…¥ API Key

# 3. ç­‰å¾…å®Œæˆ

# 4. é‡å»ºç´¢å¼•
docker exec ckan ckan -c /srv/app/ckan.ini search-index rebuild

# 5. è®¿é—®æŸ¥çœ‹
# https://opendata.uixai.org/dataset?q=plateau
```

**å®Œæˆï¼** ğŸ‰

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šæ— æ³•è¿æ¥åˆ° localhost:5000

**è§£å†³**: åœ¨ Docker å®¹å™¨å†…è¿è¡Œï¼š

```bash
docker exec -it ckan bash
python3 /srv/app/import_plateau_simple.py
# ä¿®æ”¹è„šæœ¬ä¸­çš„ LOCAL_CKAN = "http://localhost:5000"
```

### é—®é¢˜ï¼šAPI Key æƒé™ä¸è¶³

**è§£å†³**: ç¡®ä¿ä½¿ç”¨çš„æ˜¯ sysadmin ç”¨æˆ·çš„ API Key

```bash
# æ£€æŸ¥ç”¨æˆ·æƒé™
docker exec ckan ckan -c /srv/app/ckan.ini sysadmin list
```

### é—®é¢˜ï¼šæ•°æ®é›†åç§°å†²çª

**è§£å†³**: ç¼–è¾‘è„šæœ¬ï¼Œåœ¨æ¸…ç†æ•°æ®é›†æ—¶ä¿®æ”¹ nameï¼š

```python
dataset['name'] = dataset['name'] + '-imported'
```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [PLATEAU_HARVEST_GUIDE.md](PLATEAU_HARVEST_GUIDE.md) - å®Œæ•´é‡‡é›†æŒ‡å—
- [HARVEST_QUICK_ANSWER.md](HARVEST_QUICK_ANSWER.md) - å¿«é€Ÿé‡‡é›†ç­”æ¡ˆ

---

**äº«å—æ‚¨çš„ PLATEAU æ•°æ®ï¼** ğŸ™ï¸
